subsystem = IRIS
component = imager-adc-assembly

publish {

  description = "Telemetries published by Imager ADC Assembly."


  telemetry = [
	 {
    	name = status
    	description = "Current/Target ADC status"
    	minRate = 1
    	maxRate = 1
    	archive = true
    	archiveRate = 1
    	attributes = [
    		{
    			name = currentOrientation
    			description  = "Current orientation of ADC"
    			type = float
    			default = 0
    			units = TBD
    		}
    		{
    			name = currentPower
    			description  = "Current power of ADC"
    			type = float
    			default = 0
    			units = TBD
    		}
    		{
    			name = currentWavelength
    			description  = "Current wavelength corrected by ADC"
    			type = float
    			units = microns
    		}
    		{
    			name = targetOrientation
    			description  = "Target orientation of ADC"
    			type = float
    			default = 0
    			units = TBD
    		}
    		{
    			name = targetPower
    			description  = "Target power of ADC"
    			type = float
    			default = 0
    			units = TBD
    		}
    		{
    			name = targetWavelength
    			description  = "Target wavelength corrected by ADC"
    			type = float
    			units = microns
    		}
    		{
    			name = state
    			description  = """
Current overall state of ADC. Meaning of each value is as follows:  

* **BOOTED**      : Assembly is booted.
* **INITIALIZING**: Read configuration files.  
* **INITIALIZED** : Initialization is finished. Ready for datum.  
* **PREPARING**   : Moving both prisms to the home position.  
* **READY**       : Ready for following and testing.  
* **BREAKING**    : Stopping the prevoius activity.  
* **PARKINNG**    : Rotating both prisms to parking position.  
* **PARKED**      : Both prisms are at parking position in low current mode.  
* **TESTING**     : Testing communication with the motion controller.  
* **MOVING**      : Moving either or both prisms.  
* **FOLLOWING**   : Following the streams from TCS.  
* **PARKING**     : Moving to the parking position.  
* **ERROR**       : ADC encountered an error.  """
    			enum = [INITIALIZING, INITIALIZED, PREPARING, READY, PAUSING, TESTING, MOVING, FOLLOWING, PARKING, ERROR]
    		}
    		{
    			name = errorMessage
    			description  = "Error message."
			type = string
    		}
    	]
	}
	{
    	name = prism1Axis
    	description = "Prism 1 axis"
    	minRate = 1
    	maxRate = 1
    	archive = true
    	archiveRate = 1
    	attributes = [
    		{
    			name = position
    			description  = "Current position of prism 1 axis. Home position is 0."
    			type = float
    			units = degree
    			minimum = 0
    		}
    		{
    			name = rawPosition
    			description  = "Current raw position of prism 1 axis."
    			type = integer
    			units = counts 
    			minimum = 0
    			default = -1 
    		}
    		{
    			name = homeSwitch
    			description = "Current home switch state of prism 1 axis." 
    			type = boolean
    			default = false
    		}
    		{
    			name = targetPosition
    			description  = "Target position of prism 1 axis. Home position is 0."
    			type = float
    			units = degree
    			minimum = 0
    			default = -1 
    		}
    		{
    			name = targetRawPosition
    			description  = "Target raw position of prism 1 axis."
    			type = integer
    			units = counts 
    			minimum = 0
    			default = -1 
    		}
    		{
    			name = status
    			description  = """
Current status of prism 1 axis. Meaning of each value is as follows:  

* **INIT**   : Initial status right after the power of motion controller is turned on.  
* **HOMING** : Moving to home position.  
* **HOME**   : At home position (when homing fails, it goes to ERROR).  
* **PARKING**: Moving to park position.  
* **PARK**   : At park position. (This might be the same as HOME, TBD)  
* **MOVING** : Moving to the target position.  
* **TARGET** : At the target position.  
* **PAUSE**  : Motion was interrupted and stopped.  
* **ERROR**  : Error happened.
"""
			enum = [HOMING, HOME, PARKING, PARK, MOVING, STOP, ERROR, UNKNOWN]
    		}
    		{
    			name = errorMessage
    			description  = "Error message."
			type = string
    		}
    	]
    }
	{
    	name = prism2Axis
    	description = "Prism 2 axis"
    	minRate = 1
    	maxRate = 1
    	archive = true
    	archiveRate = 1
    	attributes = [
    		{
    			name = position
    			description  = "Current position of prism 2 axis. Home position is 0."
    			type = float
    			units = degree
    			minimum = 0
    		}
    		{
    			name = rawPosition
    			description  = "Current raw position of prism 2 axis."
    			type = integer
    			units = counts 
    			minimum = 0
    			default = -1 
    		}
    		{
    			name = homeSwitch
    			description = "Current home switch state of prism 2 axis." 
    			type = boolean
    			default = false
    		}
    		{
    			name = targetPosition
    			description  = "Target position of prism 2 axis. Home position is 0."
    			type = float
    			units = degree
    			minimum = 0
    			default = -1 
    		}
    		{
    			name = targetRawPosition
    			description  = "Target raw position of prism 2 axis."
    			type = integer
    			units = counts 
    			minimum = 0
    			default = -1 
    		}
    		{
    			name = status
    			description  = """
Current status of prism 2 axis. Meaning of each value is as follows:  

* **INIT**   : Initial status right after the power of motion controller is turned on.  
* **HOMING** : Moving to home position.  
* **HOME**   : At home position (when homing fails, it goes to ERROR).  
* **PARKING**: Moving to park position.  
* **PARK**   : At park position. (This might be the same as HOME, TBD)  
* **MOVING** : Moving to the target position.  
* **TARGET** : At the target position.  
* **PAUSE**  : Motion was interrupted and stopped.  
* **ERROR**  : Error happened.
"""
			enum = [HOMING, HOME, PARKING, PARK, MOVING, STOP, ERROR, UNKNOWN]
    		}
    		{
    			name = errorMessage
    			description  = "Error message."
			type = string
    		}
    	]
    }

	 {
    	name = odgwShift
    	description = """
        IRIS publishes the expected ADC image shifts of the (up to 4) IRIS ODGW position demands

        *Discussion: The ADC will shift an image position in a manner that depends upon the current state of the ADC. The estimated image shift (inferred from optical models) is sent from IRIS to the TCS so that the TCS can adjust the IRIS ODGW position demands accordingly. The reference wavelength used to calculate the shift is tcs.cm.iris.imgCurAtmDispersion.referenceWavelength.*
        """
    	minRate = 1
    	maxRate = 1
    	archive = true
    	archiveRate = 1
    	attributes = [
    		{
    			name = odgw1Shift
    			description  = "2 element array holding x, y values in the ICRS, evaluated at the reference wavelength"
    			type = array
                        dimensions: [2]
                        items = {
                              type = double
                              units = mm
                              }
    		}
    		{
    			name = odgw2Shift
    			description  = "2 element array holding x, y values in the ICRS, evaluated at the reference wavelength"
    			type = array
                        dimensions: [2]
                        items = {
                              type = double
                              units = mm
                              }
    		}
    		{
    			name = odgw3Shift
    			description  = "2 element array holding x, y values in the ICRS, evaluated at the reference wavelength"
    			type = array
                        dimensions: [2]
                        items = {
                              type = double
                              units = mm
                              }
    		}
    		{
    			name = odgw4Shift
    			description  = "2 element array holding x, y values in the ICRS, evaluated at the reference wavelength"
    			type = array
                        dimensions: [2]
                        items = {
                              type = double
                              units = mm
                              }
    		}

    	]
	}

]

}
